<!DOCTYPE html>
<html lang="en">
<head>
    <%- include('head.ejs') %>
</head>
<body>

<%

function getCurrentSprint(sprints) {
    let today = new Date();
    for (let sprint of sprints) {
        if (new Date(sprint.start) <= today && today <= new Date(sprint.end))
            return sprint.start + " - " + sprint.end;
    }
    return "Aucun"
}

%>

<div class="container">
    
    <%- include('navigation.ejs') %>

    <div class="jumbotron">
        <span class="projName"><h1>Nom du projet : <%= project.name %></h1></span>
        <span class="projDescription"><p>Description : <%= project.description %></p></span>
    </div>

    <div>
        <p>Membres <a href="/projects/<%= project._id %>/new-member" class="btn btn-primary">Nouveau membre</a></p>
        <div class="container-fluid">
            <div class="row">
                <div class="col">
                    <% project.members.forEach(function(member) { %>
                        <div class="col">
                            <span name="name"><p>Nom : <%= member.name %></p></span>
                            <span name="role"><p>Rôle : <%= member.role %></p></span>
                            <span name="email"><p>Email : <%= member.email %></p></span>
                            <span name="color"><p>Couleur : <i class="fa fa-square" style="color: #<%= member.color%>"></i></p></span>
                            <form action="/projects/<%= project._id %>/members/<%= member._id %>" method="post">
                                <button type="submit" class="btn btn-success btn-danger">Supprimer le membre</button>
                            </form>
                        </div>
                    <% }); %>
                </div>
            </div>
        </div>
        <p>Date de début : <%= new Date(project.start).toLocaleDateString() %></p>
        <p>Date de fin : <%= new Date(project.end).toLocaleDateString() %></p>

        <p>Sprint en cours : <%= getCurrentSprint(project.management.backlog.sprints) %></p>
    </div>
</div>

<footer>
    <%- include('footer.ejs') %>
</footer>

</body>
</html>
